{"version":3,"sources":["../../../../assets/Script/assets/Script/Level3.js"],"names":["game","require","cc","Class","extends","Component","properties","boardNode","Node","knifeNode","knifePrefab","Prefab","layoutKnife","Layout","labelScore","Label","knifeBoard1","knifeBoard2","knifeMini","knifeAudio","type","AudioClip","default","knifeFail","score","numberKnife","level","onLoad","createLayoutKnife","node","on","throwKnife","isThrow","boardRotation","knifeNodeArr","remainKnife","childrenCount","push","setInterval","changeSpeed","setScore","value","string","directionRotation","Math","random","speedRotation","children","active","runAction","sequence","moveTo","v2","x","y","width","callFunc","audioEngine","play","isHit","abs","angle","loseGame","createKnifePlayer","nextLevel","update","dt","angleKnife"],"mappings":";;;;;;AAAA,IAAMA,OAAOC,QAAQ,MAAR,CAAb;AACAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,mBAAWL,GAAGM,IADN;AAERC,mBAAWP,GAAGM,IAFN;AAGRE,qBAAaR,GAAGS,MAHR;AAIRC,qBAAaV,GAAGW,MAJR;AAKRC,oBAAYZ,GAAGa,KALP;AAMRC,qBAAad,GAAGM,IANR;AAORS,qBAAaf,GAAGM,IAPR;AAQRU,mBAAWhB,GAAGS,MARN;AASRQ,oBAAY;AACRC,kBAAMlB,GAAGmB,SADD;AAERC,qBAAS;AAFD,SATJ;AAaRC,mBAAW;AACPH,kBAAMlB,GAAGmB,SADF;AAEPC,qBAAS;AAFF,SAbH;AAiBRE,eAAO,CAjBC;AAkBRC,qBAAa,CAlBL;AAmBRC,eAAO;AAnBC,KAHP;;AAyBLC,UAzBK,oBAyBI;AAAA;;AACL3B,aAAK4B,iBAAL,CAAuB,EAAvB,EAA2B,KAAKV,SAAhC,EAA2C,KAAKN,WAAhD;AACA,aAAKiB,IAAL,CAAUC,EAAV,CAAa,YAAb,EAA2B,KAAKC,UAAhC,EAA4C,IAA5C;AACA,aAAKC,OAAL,GAAe,IAAf;AACA,aAAKC,aAAL,GAAqB,CAArB;AACA,aAAKC,YAAL,GAAoB,EAApB;AACA,aAAKC,WAAL,GAAmB,KAAKvB,WAAL,CAAiBiB,IAAjB,CAAsBO,aAAzC;AACA,aAAKF,YAAL,CAAkBG,IAAlB,CAAuB,KAAKrB,WAA5B,EAAyC,KAAKC,WAA9C;AACAqB,oBAAY,YAAM;AACd,kBAAKC,WAAL;AACH,SAFD,EAEG,IAFH;AAGH,KApCI;AAsCLC,YAtCK,oBAsCIC,KAtCJ,EAsCW;AACZ,aAAKjB,KAAL,GAAaiB,KAAb;AACA,aAAK3B,UAAL,CAAgB4B,MAAhB,GAAyB,KAAKlB,KAA9B;AACH,KAzCI;AA2CLe,eA3CK,yBA2CS;AACV,YAAII,oBAAoBC,KAAKC,MAAL,KAAgB,GAAhB,GAAsB,CAAtB,GAA0B,CAAC,CAAnD;AACA,YAAIC,gBAAgB,IAAIF,KAAKC,MAAL,KAAgB,CAAxC;AACA,aAAKZ,aAAL,GAAqBU,oBAAoBG,aAAzC;AACH,KA/CI;AAkDLf,cAlDK,wBAkDQ;AAAA;;AACT,YAAI,KAAKC,OAAT,EAAkB;AACd,iBAAKA,OAAL,GAAe,KAAf;AACA,iBAAKpB,WAAL,CAAiBiB,IAAjB,CAAsBkB,QAAtB,CAA+B,KAAKtB,WAApC,EAAiDuB,MAAjD,GAA0D,KAA1D;AACA,iBAAKb,WAAL;AACA,iBAAKV,WAAL;AACA,iBAAKhB,SAAL,CAAewC,SAAf,CACI/C,GAAGgD,QAAH,CACIhD,GAAGiD,MAAH,CAAU,GAAV,EAAejD,GAAGkD,EAAH,CAAM,KAAK3C,SAAL,CAAe4C,CAArB,EAAwB,KAAK9C,SAAL,CAAe+C,CAAf,GAAmB,KAAK/C,SAAL,CAAegD,KAAf,GAAuB,CAAlE,CAAf,CADJ,EAEIrD,GAAGsD,QAAH,CAAY,YAAM;AACdtD,mBAAGuD,WAAH,CAAeC,IAAf,CAAoB,OAAKnC,SAAzB,EAAoC,KAApC,EAA2C,CAA3C;AACA,oBAAIoC,QAAQ,KAAZ;AAFc;AAAA;AAAA;;AAAA;AAGd,yCAAsB,OAAKzB,YAA3B,8HAAyC;AAAA,4BAAhCzB,SAAgC;;AACrC,4BAAImC,KAAKgB,GAAL,CAASnD,UAAUoD,KAAnB,IAA4B,EAA5B,IAAmC,MAAMjB,KAAKgB,GAAL,CAASnD,UAAUoD,KAAnB,CAAP,GAAoC,EAA1E,EAA8E;AAC1EF,oCAAQ,IAAR;AACA;AACH;AACJ;AARa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AASd,oBAAIA,KAAJ,EAAW;AACP3D,yBAAK8D,QAAL,CAAc,OAAKvC,SAAnB,EAA8B,OAAKd,SAAnC,EAA8C,OAAKe,KAAnD,EAA0D,OAAKE,KAA/D;AACH,iBAFD,MAEO;AACH1B,yBAAK+D,iBAAL,CAAuB,OAAKrD,WAA5B,EAAyC,OAAKD,SAA9C,EAAyD,OAAKyB,YAA9D,EAA4E,OAAKL,IAAjF;AACA,2BAAKG,OAAL,GAAe,IAAf;AACA,2BAAKR,KAAL;AACA,2BAAKV,UAAL,CAAgB4B,MAAhB,GAAyB,OAAKlB,KAA9B;AACA,wBAAI,OAAKW,WAAL,KAAqB,CAAzB,EAA4B;AACxB,+BAAKH,OAAL,GAAe,KAAf;AACAhC,6BAAKgE,SAAL,CAAe,OAAKtC,KAApB,EAA2B,OAAKF,KAAhC;AACH;AACJ;AACJ,aArBD,CAFJ,CADJ;AA2BH;AACJ,KApFI;;;AAsFL;;AAEAyC,UAxFK,kBAwFEC,EAxFF,EAwFM;AACPlE,aAAKmE,UAAL,CAAgB,KAAK5D,SAArB,EAAgC,KAAK0B,aAArC,EAAoD,KAAKC,YAAzD;AACH;AA1FI,CAAT","file":"Level3.js","sourceRoot":"../../../../assets/Script","sourcesContent":["const game = require('Game');\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        boardNode: cc.Node,\n        knifeNode: cc.Node,\n        knifePrefab: cc.Prefab,\n        layoutKnife: cc.Layout,\n        labelScore: cc.Label,\n        knifeBoard1: cc.Node,\n        knifeBoard2: cc.Node,\n        knifeMini: cc.Prefab,\n        knifeAudio: {\n            type: cc.AudioClip,\n            default: null,\n        },\n        knifeFail: {\n            type: cc.AudioClip,\n            default: null,\n        },\n        score: 0,\n        numberKnife: 0,\n        level: 3,\n    },\n\n    onLoad() {\n        game.createLayoutKnife(10, this.knifeMini, this.layoutKnife);\n        this.node.on('touchstart', this.throwKnife, this);\n        this.isThrow = true;\n        this.boardRotation = 3;\n        this.knifeNodeArr = [];\n        this.remainKnife = this.layoutKnife.node.childrenCount;\n        this.knifeNodeArr.push(this.knifeBoard1, this.knifeBoard2);\n        setInterval(() => {\n            this.changeSpeed();\n        }, 3000);\n    },\n\n    setScore(value) {\n        this.score = value;\n        this.labelScore.string = this.score;\n    },\n\n    changeSpeed() {\n        let directionRotation = Math.random() > 0.5 ? 1 : -1;\n        let speedRotation = 1 + Math.random() * 4;\n        this.boardRotation = directionRotation * speedRotation;\n    },\n\n\n    throwKnife() {\n        if (this.isThrow) {\n            this.isThrow = false;\n            this.layoutKnife.node.children[this.numberKnife].active = false;\n            this.remainKnife--;\n            this.numberKnife++;\n            this.knifeNode.runAction(\n                cc.sequence(\n                    cc.moveTo(0.1, cc.v2(this.knifeNode.x, this.boardNode.y - this.boardNode.width / 2)),\n                    cc.callFunc(() => {\n                        cc.audioEngine.play(this.knifeFail, false, 1);\n                        let isHit = false;\n                        for (let knifeNode of this.knifeNodeArr) {\n                            if (Math.abs(knifeNode.angle) < 15 || (360 - Math.abs(knifeNode.angle)) < 15) {\n                                isHit = true;\n                                break;\n                            }\n                        }\n                        if (isHit) {\n                            game.loseGame(this.knifeFail, this.knifeNode, this.score, this.level);\n                        } else {\n                            game.createKnifePlayer(this.knifePrefab, this.knifeNode, this.knifeNodeArr, this.node);\n                            this.isThrow = true;\n                            this.score++;\n                            this.labelScore.string = this.score;\n                            if (this.remainKnife === 0) {\n                                this.isThrow = false;\n                                game.nextLevel(this.level, this.score);\n                            }\n                        }\n                    })\n                )\n            );\n        }\n    },\n\n    // start () {},\n\n    update(dt) {\n        game.angleKnife(this.boardNode, this.boardRotation, this.knifeNodeArr);\n    },\n});"]}